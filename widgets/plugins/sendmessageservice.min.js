/*!
 * widgets
 * @version: 9.0.017.30
 * @license: Genesys Telecom Labs
 */
widgetsJsonpFunction([25],{"./webapp/plugins/cx-send-message-service/cx-send-message-service.js":function(e,t,a){"use strict";var s,r,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};s=[a("./node_modules/jquery/dist/jquery.js"),a("./webapp/plugins/cx-common/cx-common.js")],void 0!==(r=function(e,t){var a=CXBus.registerPlugin("SendMessageService");if(a){var s={dataURL:"",iApiKey:"",iAjaxTimeout:3e3,uploadsEnabled:!0},r=function(){return!!window.FormData},o={},i=function(e,t,s,r){400==e.status?e.responseText=JSON.parse(e.responseText):500==e.status&&(e.statusCode=202),a.publish("error",{result:e.responseText,textStatus:t,statusCode:e.status}),r.reject()},d=function(e,t,r,n){var o=s.uploadsEnabled?JSON.parse(e):e;o.interactionId?(a.publish("messageSent",{interactionId:o.interactionId}),n.resolve()):(e=JSON.parse(e),a.publish("error",{result:e,textStatus:t,jqXHR:r}),n.reject())},u=function(e){s.iApiKey&&e.setRequestHeader("apikey",s.iApiKey),s.ccid&&e.setRequestHeader("ContactCenterId",s.ccid)};a.registerEvents(["ready","messageSent","error"]),a.registerCommand("sendForm",function(t){if(t.data){var a=t.data.formData,n=e.extend({},o,t.data.userData||{});if(s.uploadsEnabled)if(r()){var c=new FormData;c.append("lastName",a.lastname||a.lastName||""),c.append("firstName",a.firstname||a.firstName||""),c.append("fromAddress",a.email||""),c.append("subject",a.subject||""),c.append("text",a.text||a.messagebody||"");for(var p in n)c.append("userData",p+"="+n[p]);t.data.files&&e.each(t.data.files,function(e,t){c.append("files",t)}),e.ajax({type:"POST",url:s.dataURL,mimeType:"multipart/form-data",contentType:!1,crossDomain:!0,processData:!1,data:c,beforeSend:u,success:function(e,a,s){d(e,a,s,t.deferred)},error:function(e,a,s){i(e,a,0,t.deferred)}})}else t.deferred.reject("No HTMl5 formData support on your browser");else{var m,f=[],l={firstName:a.firstName||a.firstname||"",lastName:a.lastName||a.lastname||"",fromAddress:a.email||"",subject:a.subject||"",text:a.text||a.messagebody||""};for(var p in l)f.push(encodeURIComponent(p)+"="+encodeURIComponent(l[p]));for(var p in n)f.push("userData="+encodeURIComponent(p+"="+n[p]));m=f.join("&").replace(/%20/g,"+"),e.ajax({type:"POST",url:s.dataURL,crossDomain:!0,timeout:s.iAjaxTimeout,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:m,beforeSend:u,success:function(e,a,s){d(e,a,s,t.deferred)},error:function(e,a,s){i(e,a,0,t.deferred)}})}}else t.deferred.reject("No formData found")}),a.subscribe("GWE.ready",function(){a.command("GWE.getIDs").done(function(t){e.extend(o,t)})}),a.registerCommand("configure",function(t){if(t.data){var a=t.data;"string"==typeof a.dataURL&&(s.dataURL=a.dataURL),"string"!=typeof a.apikey&&"number"!=typeof a.apikey||(s.iApiKey=a.apikey),"number"==typeof a.ajaxTimeout&&(s.iAjaxTimeout=parseInt(a.ajaxTimeout)),"boolean"==typeof a.uploadsEnabled&&(s.uploadsEnabled=a.uploadsEnabled),"object"==n(a.userData)&&e.extend(o,a.userData),a.ccid&&(s.ccid=a.ccid),t.deferred.resolve()}else t.deferred.reject("Invalid configuration")}),a.command("configure",_genesys.widgets.sendmessage),a.ready(),a.republish("ready")}}.apply(t,s))&&(e.exports=r)}},["./webapp/plugins/cx-send-message-service/cx-send-message-service.js"]);